import{d as N,u as M,j as u,c as T,a as t,o as n,b as s,e as m,f as C,g as E,t as _,y as g,v as h,n as P,aa as B,_ as D}from"./index-BuxX1puY.js";const $={class:"user-center-container"},j={class:"user-center-card"},z={class:"card-content"},J={class:"info-section"},L={class:"form-group"},O={class:"field-content"},R={key:0,class:"display-value"},q={class:"form-group"},A={class:"field-content"},F={key:0,class:"display-value"},G={key:0,class:"form-group"},H={class:"field-content"},K={key:0,class:"error-message"},Q={class:"form-group"},W={class:"field-content"},X={class:"action-section"},Y={key:1,class:"button-group"},Z=["disabled"],ee={key:0,class:"fas fa-spinner fa-spin"},se={key:1,class:"fas fa-save"},ae=N({__name:"userInfoPage",setup(le){const a=M(),i=u(!1),d=u(a.email),c=u(a.username),o=u(""),r=u(""),b=u(""),y=u(""),f=u(!1);function p(){b.value="",y.value=""}function U(l){p(),b.value=l,setTimeout(()=>{b.value=""},5e3)}function k(l){p(),y.value=l,setTimeout(()=>{y.value=""},8e3)}function w(l){return!l||l.trim()===""?(r.value="Password cannot be empty or contain only spaces",!1):l.length<6?(r.value="Password must be at least 6 characters long",!1):l.includes(" ")?(r.value="Password cannot contain spaces",!1):(r.value="",!0)}const x=T(()=>i.value?!(o.value&&!w(o.value)):!0);function I(){if(p(),o.value&&!w(o.value)){k("请先修复密码错误再保存。");return}f.value=!0,B(a.userId,d.value,c.value,o.value,JSON.stringify(a.userData)).then(l=>{l?(a.username=c.value,a.email=d.value,i.value=!1,o.value="",U("用户信息更新成功！您的资料已保存。")):k("更新失败，请检查您的旧密码是否正确，或稍后再试。")}).catch(l=>{console.error("Error updating user information:",l),k("网络错误，无法连接到服务器，请检查网络连接后重试。")}).finally(()=>{f.value=!1})}function S(){p(),i.value=!0,c.value=a.username,d.value=a.email}function V(){p(),i.value=!1,c.value=a.username,d.value=a.email,o.value="",r.value=""}return(l,e)=>(n(),t("div",$,[s("div",j,[e[12]||(e[12]=s("div",{class:"card-header"},[s("h1",{class:"page-title"},[s("i",{class:"fas fa-user-circle"}),m(" User Center ")])],-1)),s("div",z,[s("div",J,[e[9]||(e[9]=s("h5",{class:"section-title"},"Personal Information",-1)),s("div",L,[e[4]||(e[4]=s("label",{class:"field-label"},"Username:",-1)),s("div",O,[i.value?E((n(),t("input",{key:1,"onUpdate:modelValue":e[0]||(e[0]=v=>c.value=v),type:"text",class:"form-input",placeholder:"Enter your username"},null,512)),[[h,c.value]]):(n(),t("span",R,_(g(a).username),1))])]),s("div",q,[e[5]||(e[5]=s("label",{class:"field-label"},"Email:",-1)),s("div",A,[i.value?E((n(),t("input",{key:1,"onUpdate:modelValue":e[1]||(e[1]=v=>d.value=v),type:"email",class:"form-input",placeholder:"Enter your email"},null,512)),[[h,d.value]]):(n(),t("span",F,_(g(a).email),1))])]),i.value?(n(),t("div",G,[e[7]||(e[7]=s("label",{class:"field-label"},"New Password:",-1)),s("div",H,[E(s("input",{"onUpdate:modelValue":e[2]||(e[2]=v=>o.value=v),type:"password",class:P(["form-input",{error:r.value}]),placeholder:"Enter new password (optional)",onInput:e[3]||(e[3]=v=>w(o.value))},null,34),[[h,o.value]]),r.value?(n(),t("div",K,[e[6]||(e[6]=s("i",{class:"fas fa-exclamation-circle"},null,-1)),m(" "+_(r.value),1)])):C("",!0)])])):C("",!0),s("div",Q,[e[8]||(e[8]=s("label",{class:"field-label"},"Role:",-1)),s("div",W,[s("span",{class:P(["role-badge",`role-${g(a).role}`])},_(g(a).role),3)])])]),s("div",X,[i.value?(n(),t("div",Y,[s("button",{class:"btn btn-save",onClick:I,disabled:!x.value||f.value},[f.value?(n(),t("i",ee)):(n(),t("i",se)),m(" "+_(f.value?"正在保存...":"Save Changes"),1)],8,Z),s("button",{class:"btn btn-cancel",onClick:V},[...e[11]||(e[11]=[s("i",{class:"fas fa-times"},null,-1),m(" Cancel ",-1)])])])):(n(),t("button",{key:0,class:"btn btn-edit",onClick:S},[...e[10]||(e[10]=[s("i",{class:"fas fa-edit"},null,-1),m(" Edit Profile ",-1)])]))])])])]))}}),ne=D(ae,[["__scopeId","data-v-2dd4de41"]]);export{ne as default};
